<HTML>
<HEAD>
<TITLE>
jniclass.h
</TITLE>
</HEAD>
<BODY>
<PRE>
<font color="blue">#ifndef</font> JNICLASS_H
<font color="blue">#define</font> JNICLASS_H

<font color="blue">#include</font> <font color="maroon">&#60;jni.h&#62;</font>
<font color="blue">#include</font> <font color="maroon">"jnivalue.h"</font>
<font color="blue">#include</font> <font color="maroon">"jniobject.h"</font>

<font color="blue">namespace</font> jni <font color="black">{</font>

  <font color="green">/**
   * type definition of the access modifiers of a Java Class.
   * These values are taken straight from the Java Language Specification (Java SE 7 Edition), table 4.1
   */</font>
  <font color="blue">enum</font> AccModifier <font color="black">{</font>
    ACC_PUBLIC     <font color="black">=</font> <font color="maroon">0x0001</font>,
    ACC_PRIVATE    <font color="black">=</font> <font color="maroon">0x0002</font>,
    ACC_PROTECTED  <font color="black">=</font> <font color="maroon">0x0004</font>,
    ACC_STATIC     <font color="black">=</font> <font color="maroon">0x0008</font>,
    ACC_FINAL      <font color="black">=</font> <font color="maroon">0x0010</font>,
    ACC_SUPER      <font color="black">=</font> <font color="maroon">0x0020</font>,
    ACC_VOLATILE   <font color="black">=</font> <font color="maroon">0x0040</font>,
    ACC_TRANSIENT  <font color="black">=</font> <font color="maroon">0x0080</font>,
    ACC_NATIVE     <font color="black">=</font> <font color="maroon">0x0100</font>,
    ACC_INTERFACE  <font color="black">=</font> <font color="maroon">0x0200</font>,
    ACC_ABSTRACT   <font color="black">=</font> <font color="maroon">0x0400</font>,
    ACC_STRICT     <font color="black">=</font> <font color="maroon">0x0800</font>,
    ACC_SYNTHETIC  <font color="black">=</font> <font color="maroon">0x1000</font>,
    ACC_ANNOTATION <font color="black">=</font> <font color="maroon">0x2000</font>,
    ACC_ENUM       <font color="black">=</font> <font color="maroon">0x4000</font>
  <font color="black">}</font>;

  <font color="green">// These are defines that give the proper semantic names for access flags of methods.</font>
  <font color="green">// This is required because these flags overlap with the access flags of fields.</font>
<font color="blue">#define</font> ACC_SYNCHRONIZED jni<font color="black">:</font><font color="black">:</font>ACC_SUPER
<font color="blue">#define</font> ACC_BRIDGE jni<font color="black">:</font><font color="black">:</font>ACC_VOLATILE
<font color="blue">#define</font> ACC_VARARGS jni<font color="black">:</font><font color="black">:</font>ACC_TRANSIENT

  <font color="green">/**
   * @brief Representation of a Class in the Java environment
   *
   */</font>
  <font color="blue">class</font> JNIClass <font color="black">:</font> <font color="blue">public</font> JNIObject <font color="black">{</font>
    <font color="blue">private</font><font color="black">:</font>
      <font color="green">// reference values</font>
      jclass clazz;

      <font color="green">// cached values</font>
      JNIClass<font color="black">*</font> superClass;       <font color="green">// This JNIClass' superclass</font>
      QString<font color="black">*</font> <font color="blue">name</font>;              <font color="green">// The fully qualified name (with '/' as separator) for use in signatures of functions.</font>
      QString<font color="black">*</font> semantic_name;     <font color="green">// The semantic name given to this JNIClass object for easy identification.</font>
      jint modifiers;             <font color="green">// The modifiers of the class (a combination of public, protected, private, final, static, abstract and interface, encoded in an integer)</font>
      map<font color="black">&#60;</font>JNIClass<font color="black">*</font>, JNIValue<font color="black">*</font><font color="black">&#62;</font> anns;    <font color="green">// Map of annotations this JNIClass contains</font>
      map<font color="black">&#60;</font>QString, JNIMethod<font color="black">*</font><font color="black">&#62;</font> methods; <font color="green">// Map of methods that this class provides.</font>
      map<font color="black">&#60;</font>QString, jfieldID<font color="black">&#62;</font> fields;    <font color="green">// Map of field that this class provides.</font>
    <font color="blue">public</font><font color="black">:</font>
      <font color="green">/**
       * @brief Creates a JNIClass based on the given jclass reference
       * @param c the jclass this JNIClass object represents
       * @param e the Java environment
       */</font>
      JNIClass<font color="black">(</font>jclass c, JavaEnv <font color="black">*</font>e<font color="black">)</font> <font color="black">:</font> JNIObject<font color="black">(</font>e, c<font color="black">)</font> <font color="black">{</font><font color="black">}</font>

      ~JNIClass<font color="black">(</font><font color="black">)</font> <font color="black">{</font><font color="black">}</font>

      virtual jclass GetJObject<font color="black">(</font><font color="black">)</font> <font color="black">{</font> <font color="blue">return</font> clazz; <font color="black">}</font>

      <font color="green">/**
       * @brief Returns the simple name (without package) of the class
       * @return the simple name of the class
       */</font>
      QString GetSimpleName<font color="black">(</font><font color="black">)</font>;
      <font color="green">/**
       * @brief Returns the signature name of the class.
       * The signature name contains the full package (separated by '/').
       * @return the signature name of this class
       */</font>
      QString GetSigName<font color="black">(</font><font color="black">)</font>;

      <font color="green">/**
       * @brief Returns whether the given JNIObject represents an instance of this JNIClass
       * @param o the JNIObject to check
       *
       * @return true if the provided JNIObject is an @c JOBJECT of this JNIClass, false otherwise
       */</font>
      jboolean IsInstance<font color="black">(</font>JNIObject o<font color="black">)</font>;
      <font color="green">/**
       * @brief Returns whether the given jobject is an instance of this JNIClass
       * @param o the jobject to check
       * @return true if the jobject is an instance of this JNIClass, false otherwise
       */</font>
      jboolean IsInstance<font color="black">(</font>jobject o<font color="black">)</font>;

      <font color="green">/**
       * @brief Returns the superclass of this JNIClass
       * @return the superclass of this JNIClass
       */</font>
      JNIClass<font color="black">*</font> GetSuperClass<font color="black">(</font><font color="black">)</font>;
      <font color="green">/**
       * @brief Looks up the method with the specified name and signature
       * @param name the name of the method
       * @param signature the signature of the method
       * @return the JNIMethod reference to the requested method, or @c NULL if no such method exists
       */</font>
      JNIMethod<font color="black">*</font> GetMethod<font color="black">(</font><font color="blue">const</font> <font color="blue">char</font><font color="black">*</font> <font color="blue">name</font>, <font color="blue">const</font> <font color="blue">char</font><font color="black">*</font> signature<font color="black">)</font>;
      <font color="green">/**
       * @brief Looks up the constructor with the specified signature
       * @param signature the signature of the constructor
       * @return the JNIMethod reference to the requested constructor, or @c NULL if no such constructor exists
       */</font>
      JNIMethod<font color="black">*</font> GetConstructor<font color="black">(</font>QString signature<font color="black">)</font>;

      <font color="green">/**
       * @brief Returns the signature of the field with the given name
       * @param fieldname the fieldname to look up
       * @return the signature of the requested fieldname if it exists, or an empty QString otherwise
       */</font>
      QString GetFieldSignature<font color="black">(</font>QString fieldname<font color="black">)</font>;
      <font color="green">/**
       * @brief Returns the type of the field as a jvalue_type id
       * @param fieldname the name of the field to look up
       * @return the jvalue_type representing the field's type
       */</font>
      jvalue_type GetFieldType<font color="black">(</font>QString fieldname<font color="black">)</font>;
      <font color="green">/**
       * @brief Returns the contents of the field with the given name
       * @param fieldName the name of the field
       * @return the JNIValue with this field's contents.
       */</font>
      JNIValue GetFieldContents<font color="black">(</font>QString fieldName<font color="black">)</font>;

      <font color="green">/**
       * @brief Retrieves the Access modifiers for this class
       * @return the access modifiers for this class
       */</font>
      jint GetModifiers<font color="black">(</font><font color="black">)</font>;
      <font color="green">/**
       * @brief Returns whether this JNIClass has the given access modifier
       * @param m the AccModifier to check for
       * @return @c (GetModifiers() & m != 0)
       */</font>
      jboolean HasModifier<font color="black">(</font>AccModifier m<font color="black">)</font> <font color="black">{</font> <font color="blue">return</font> <font color="black">(</font>GetModifiers<font color="black">(</font><font color="black">)</font> <font color="black">&</font> m<font color="black">)</font> <font color="black">!</font><font color="black">=</font> <font color="maroon">0</font>; <font color="black">}</font>

      <font color="green">/**
       * @brief Returns the annotation object belonging to the given class.
       * @param annotationClass the class of the annotation to retrieve
       * @return the JNIObject representing the requested annotation, or a JNIObject representing @c NULL if the annotation was not found
       */</font>
      JNIObject GetAnnotation<font color="black">(</font>JNIClass<font color="black">*</font> annotationClass<font color="black">)</font>;
      <font color="green">/**
       * @brief Returns whether this class contains the given annotation
       * @param annotationClass the class of the annotation to check
       *
       * @return @c !GetAnnotation(annotationClass).IsNull()
       */</font>
      jboolean HasAnnotation<font color="black">(</font>JNIClass<font color="black">*</font> annotationClass<font color="black">)</font> <font color="black">{</font> <font color="blue">return</font> <font color="black">!</font>GetAnnotation<font color="black">(</font>annotationClass<font color="black">)</font>.IsNull<font color="black">(</font><font color="black">)</font>; <font color="black">}</font>

      JNIValue InvokeStaticMethod<font color="black">(</font>QString <font color="blue">name</font>, QString signature, ...<font color="black">)</font>;
      JNIValue InvokeStaticMethod<font color="black">(</font>JNIMethod<font color="black">*</font> method, ...<font color="black">)</font>;

      <font color="blue">void</font> emptyCache<font color="black">(</font><font color="black">)</font>;

  <font color="black">}</font>;
<font color="black">}</font>

<font color="blue">#endif</font> <font color="green">// JNICLASS_H</font>

</PRE>
</BODY>
</HTML>
